{"version":3,"file":"updatePackageVersions.js","sourceRoot":"","sources":["../../../src/publish-packages/tasks/updatePackageVersions.ts"],"names":[],"mappings":";;;;;;AAAA,gEAAuC;AACvC,kDAA0B;AAC1B,gDAAwB;AAExB,0DAAkC;AAClC,mDAAyC;AAEzC,uEAAoE;AAEpE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,eAAK,CAAC;AAEvC;;GAEG;AACU,QAAA,qBAAqB,GAAG,IAAI,kBAAI,CAC3C;IACE,IAAI,EAAE,uBAAuB;IAC7B,SAAS,EAAE,CAAC,iDAAuB,CAAC;IACpC,YAAY,EAAE,CAAC,0BAA0B,CAAC;CAC3C,EACD,KAAK,EAAE,OAAiB,EAAE,EAAE;IAC1B,gBAAM,CAAC,IAAI,CAAC,6BAA6B,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;IAE7E,MAAM,OAAO,CAAC,GAAG,CACf,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,EAAE,GAAG,EAAE,KAAK,EAAE,EAAE,EAAE;QACnC,MAAM,mBAAQ,CAAC,QAAQ,CACrB,cAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,cAAc,CAAC,EACnC,SAAS,EACT,KAAK,CAAC,cAAc,CACrB,CAAC;QACF,gBAAM,CAAC,GAAG,CACR,IAAI,EACJ,GAAG,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,GAAG,EAC5B,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,cAAe,CAAC,EAAE,CAC1E,CAAC;IACJ,CAAC,CAAC,CACH,CAAC;AACJ,CAAC,CACF,CAAC","sourcesContent":["import JsonFile from '@expo/json-file';\nimport chalk from 'chalk';\nimport path from 'path';\n\nimport logger from '../../Logger';\nimport { Task } from '../../TasksRunner';\nimport { Parcel, TaskArgs } from '../types';\nimport { selectPackagesToPublish } from './selectPackagesToPublish';\n\nconst { magenta, cyan, green } = chalk;\n\n/**\n * Updates versions in packages selected to be published.\n */\nexport const updatePackageVersions = new Task<TaskArgs>(\n  {\n    name: 'updatePackageVersions',\n    dependsOn: [selectPackagesToPublish],\n    filesToStage: ['packages/**/package.json'],\n  },\n  async (parcels: Parcel[]) => {\n    logger.info(`\\nðŸ†™ Updating versions in ${magenta.bold('package.json')}s...`);\n\n    await Promise.all(\n      parcels.map(async ({ pkg, state }) => {\n        await JsonFile.setAsync(\n          path.join(pkg.path, 'package.json'),\n          'version',\n          state.releaseVersion\n        );\n        logger.log(\n          '  ',\n          `${green(pkg.packageName)}:`,\n          `${cyan.bold(pkg.packageVersion)} -> ${cyan.bold(state.releaseVersion!)}`\n        );\n      })\n    );\n  }\n);\n"]}