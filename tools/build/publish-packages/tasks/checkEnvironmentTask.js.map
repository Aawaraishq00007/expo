{"version":3,"file":"checkEnvironmentTask.js","sourceRoot":"","sources":["../../../src/publish-packages/tasks/checkEnvironmentTask.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,kDAA0B;AAE1B,0DAAkC;AAClC,+CAAiC;AACjC,mDAAyC;AAGzC,MAAM,EAAE,IAAI,EAAE,GAAG,eAAK,CAAC;AAEvB;;GAEG;AACU,QAAA,oBAAoB,GAAG,IAAI,kBAAI,CAC1C;IACE,IAAI,EAAE,sBAAsB;IAC5B,QAAQ,EAAE,IAAI;CACf,EACD,KAAK,IAA4B,EAAE;IACjC,MAAM,OAAO,GAAG,MAAM,GAAG,CAAC,WAAW,EAAE,CAAC;IAExC,IAAI,CAAC,OAAO,EAAE;QACZ,gBAAM,CAAC,KAAK,CACV,mFAAmF,CACpF,CAAC;QACF,OAAO,kBAAI,CAAC,IAAI,CAAC;KAClB;IAED,MAAM,WAAW,GAAG,MAAM,GAAG,CAAC,mBAAmB,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAC;IAEjF,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE;QAClC,gBAAM,CAAC,KAAK,CACV,qBAAqB,IAAI,CAAC,GAAG,CAAC,yBAAyB,CAAC,2BAA2B,CACpF,CAAC;QACF,OAAO,kBAAI,CAAC,IAAI,CAAC;KAClB;AACH,CAAC,CACF,CAAC","sourcesContent":["import chalk from 'chalk';\n\nimport logger from '../../Logger';\nimport * as Npm from '../../Npm';\nimport { Task } from '../../TasksRunner';\nimport { TaskArgs } from '../types';\n\nconst { cyan } = chalk;\n\n/**\n * Checks whether the environment allows to proceed with any further tasks.\n */\nexport const checkEnvironmentTask = new Task<TaskArgs>(\n  {\n    name: 'checkEnvironmentTask',\n    required: true,\n  },\n  async (): Promise<void | symbol> => {\n    const npmUser = await Npm.whoamiAsync();\n\n    if (!npmUser) {\n      logger.error(\n        '❗️ You must be logged in to NPM to publish packages, please run `npm login` first'\n      );\n      return Task.STOP;\n    }\n\n    const teamMembers = await Npm.getTeamMembersAsync(Npm.EXPO_DEVELOPERS_TEAM_NAME);\n\n    if (!teamMembers.includes(npmUser)) {\n      logger.error(\n        `❗️ You must be in ${cyan(Npm.EXPO_DEVELOPERS_TEAM_NAME)} team to publish packages`\n      );\n      return Task.STOP;\n    }\n  }\n);\n"]}