{"version":3,"file":"AndroidClientBuilder.js","sourceRoot":"","sources":["../../src/client-build/AndroidClientBuilder.ts"],"names":[],"mappings":";;;;;AAAA,wDAA0B;AAC1B,gDAAwB;AAExB,4CAA2C;AAC3C,wDAA4D;AAC5D,oCAAsC;AAGtC,MAAqB,oBAAoB;IAAzC;QACE,aAAQ,GAAa,SAAS,CAAC;IA8BjC,CAAC;IA5BC,UAAU;QACR,OAAO,cAAI,CAAC,IAAI,CAAC,uBAAW,EAAE,KAAK,EAAE,OAAO,EAAE,SAAS,EAAE,KAAK,EAAE,SAAS,EAAE,iBAAiB,CAAC,CAAC;IAChG,CAAC;IAED,YAAY,CAAC,UAAkB;QAC7B,OAAO,kDAAkD,UAAU,MAAM,CAAC;IAC5E,CAAC;IAED,KAAK,CAAC,kBAAkB;QACtB,OAAO,wCAAsB,EAAE,CAAC;IAClC,CAAC;IAED,KAAK,CAAC,UAAU;QACd,MAAM,kBAAU,CAAC,UAAU,EAAE,CAAC,SAAS,EAAE,OAAO,EAAE,oBAAoB,CAAC,EAAE,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC,CAAC;IACjG,CAAC;IAED,KAAK,CAAC,gBAAgB,CAAC,QAAkB,EAAE,UAAkB;QAC3D,MAAM,IAAI,GAAG,kBAAE,CAAC,gBAAgB,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC;QAEpD,MAAM,QAAQ;aACX,SAAS,CAAC;YACT,MAAM,EAAE,kBAAkB;YAC1B,GAAG,EAAE,YAAY,UAAU,MAAM;YACjC,IAAI,EAAE,IAAI;YACV,GAAG,EAAE,aAAa;SACnB,CAAC;aACD,OAAO,EAAE,CAAC;IACf,CAAC;CACF;AA/BD,uCA+BC","sourcesContent":["import fs from 'fs-extra';\nimport path from 'path';\n\nimport { ANDROID_DIR } from '../Constants';\nimport { androidAppVersionAsync } from '../ProjectVersions';\nimport { spawnAsync } from '../Utils';\nimport { ClientBuilder, Platform, S3Client } from './types';\n\nexport default class AndroidClientBuilder implements ClientBuilder {\n  platform: Platform = 'android';\n\n  getAppPath(): string {\n    return path.join(ANDROID_DIR, 'app', 'build', 'outputs', 'apk', 'release', 'app-release.apk');\n  }\n\n  getClientUrl(appVersion: string): string {\n    return `https://d1ahtucjixef4r.cloudfront.net/Exponent-${appVersion}.apk`;\n  }\n\n  async getAppVersionAsync(): Promise<string> {\n    return androidAppVersionAsync();\n  }\n\n  async buildAsync() {\n    await spawnAsync('fastlane', ['android', 'build', 'build_type:Release'], { stdio: 'inherit' });\n  }\n\n  async uploadBuildAsync(s3Client: S3Client, appVersion: string) {\n    const file = fs.createReadStream(this.getAppPath());\n\n    await s3Client\n      .putObject({\n        Bucket: 'exp-android-apks',\n        Key: `Exponent-${appVersion}.apk`,\n        Body: file,\n        ACL: 'public-read',\n      })\n      .promise();\n  }\n}\n"]}